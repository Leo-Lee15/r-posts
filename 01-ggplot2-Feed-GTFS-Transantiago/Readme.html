<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<title></title>

<script src="Readme_files/jquery-1.11.0/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link href="Readme_files/bootstrap-2.3.2/css/bootstrap.min.css" rel="stylesheet" />
<link href="Readme_files/bootstrap-2.3.2/css/bootstrap-responsive.min.css" rel="stylesheet" />
<script src="Readme_files/bootstrap-2.3.2/js/bootstrap.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="Readme_files/highlight/default.css"
      type="text/css" />
<script src="Readme_files/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
</style>
<div class="container-fluid main-container">




<p>GTFS stands from <em>General Transit Feed Specification</em> and is a format for public transportation schedules and geographic data. And like data, is fun to use in R.</p>
<p>Usually is a zip file with txt files: <code>routes.txt</code>, <code>shapes.txt</code>, <code>stations.txt</code>, etc. And define</p>
<pre class="r"><code>library(ggplot2)
shapes &lt;- read.csv(&quot;data/shapes.txt&quot;)</code></pre>
<p>The content is the</p>
<table>
<thead>
<tr class="header">
<th align="left">shape_id</th>
<th align="right">shape_pt_lat</th>
<th align="right">shape_pt_lon</th>
<th align="right">shape_pt_sequence</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">225-I-BASE</td>
<td align="right">-33.39</td>
<td align="right">-70.55</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">225-I-BASE</td>
<td align="right">-33.39</td>
<td align="right">-70.55</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">225-I-BASE</td>
<td align="right">-33.39</td>
<td align="right">-70.54</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">225-I-BASE</td>
<td align="right">-33.39</td>
<td align="right">-70.54</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">225-I-BASE</td>
<td align="right">-33.39</td>
<td align="right">-70.54</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">225-I-BASE</td>
<td align="right">-33.39</td>
<td align="right">-70.54</td>
<td align="right">5</td>
</tr>
</tbody>
</table>
<p>So, itâ€™s ultra simple plot with ggplot.</p>
<pre class="r"><code>p &lt;- ggplot(shapes) +
  geom_path(aes(shape_pt_lon, shape_pt_lat, group=shape_id), size=.2, alpha=.1) +
  coord_equal()
p</code></pre>
<p><img src="Readme_files/figure-html/unnamed-chunk-4.png" title="plot of chunk unnamed-chunk-4" alt="plot of chunk unnamed-chunk-4" width="672" /></p>
<p>You can also embed plots, for example: You can also embed plots, for example: You can also embed plots, for example: You can also embed plots, for example: You can also embed plots, for example: You can also embed plots, for example: You can also embed plots, for example: You can also embed plots, for example:</p>
<pre class="r"><code>library(devtools)
library(plyr)
library(dplyr)
source_url(&quot;https://raw.githubusercontent.com/jbkunst/reuse/master/R/gg_themes.R&quot;)</code></pre>
<p>You can also embed plots, for example: You can also embed plots, for example: You can also embed plots, for example: You can also embed plots, for example: You can also embed plots, for example: You can also embed plots, for example: You can also embed plots, for example: You can also embed plots, for example:</p>
<pre class="r"><code>routes &lt;- read.csv(&quot;data/routes.txt&quot;)
trips &lt;- read.csv(&quot;data/trips.txt&quot;)
stops &lt;- read.csv(&quot;data/stops.txt&quot;)

stops_metro &lt;- stops %&gt;% filter(!grepl(&quot;\\d&quot;, stop_id))

shapes_colors &lt;- left_join(left_join(shapes %&gt;% select(shape_id) %&gt;% unique(),
                                     trips %&gt;% select(shape_id, route_id) %&gt;% unique(),
                                     by=&quot;shape_id&quot;),
                           routes %&gt;% select(route_id, route_color) %&gt;% unique(),
                           by = &quot;route_id&quot;)

shapes_colors &lt;- shapes_colors  %&gt;% mutate(route_color = paste0(&quot;#&quot;, route_color))

routes_metro &lt;- routes %&gt;% filter(grepl(&quot;^L\\d&quot;,route_id))

shapes_metro &lt;- shapes %&gt;% filter(shape_id %in% trips$shape_id[trips$route_id %in% routes_metro$route_id])

shapes_colors_metro &lt;- shapes_colors %&gt;% filter(shape_id %in% trips$shape_id[trips$route_id %in% routes_metro$route_id])</code></pre>
<p>Note that the <code>echo = FALSE</code> parameter was added to the code chunk to prevent printing of the R code that generated the plot. Note that the <code>echo = FALSE</code> parameter was added to the code chunk to prevent printing of the R code that generated the plot. Note that the <code>echo = FALSE</code> parameter was added to the code chunk to prevent printing of the R code that generated the plot. Note that the <code>echo = FALSE</code> parameter was added to the code chunk to prevent printing of the R code that generated the plot.</p>
<pre class="r"><code>p2 &lt;- ggplot() +
  geom_path(data=shapes, aes(shape_pt_lon, shape_pt_lat, group=shape_id),
            color=&quot;white&quot;, size=.2, alpha=.1) +
  geom_path(data=shapes_metro, aes(shape_pt_lon, shape_pt_lat, group=shape_id, colour=shape_id),
            size = 2, alpha=.7) +
  scale_color_manual(values=shapes_colors_metro$route_color) +
  geom_point(data=stops_metro, aes(stop_lon, stop_lat),
             shape=21, colour=&quot;white&quot;, alpha =.8) +
  coord_equal() +
  theme_null() +
  theme(plot.background = element_rect(fill = &quot;black&quot;, colour = &quot;black&quot;),
        title = element_text(hjust=1, colour=&quot;white&quot;)) +
  ggtitle(&quot;TRANSANTIAGO\nSantiago&#39;s public transport system&quot;)
p2</code></pre>
<p><img src="Readme_files/figure-html/unnamed-chunk-7.png" title="plot of chunk unnamed-chunk-7" alt="plot of chunk unnamed-chunk-7" width="672" /></p>
<p>Note that the <code>echo = FALSE</code> parameter was added to the code chunk to prevent printing of the R code that generated the plot. Note that the <code>echo = FALSE</code> parameter was added to the code chunk to prevent printing of the R code that generated the plot.</p>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
